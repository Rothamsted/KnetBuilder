<?xml version="1.0" encoding="UTF-8"?>
<!-- 
	This is the same descriptor found in the Maven module workflow-component-descriptor, except we pick up the 
	locally-generated workflow-component-description.xml file. That seems necessary to do after the version of that file 
	coming from dependencies has been excluded (in the POM). 
-->
<assembly>
	<id>jar-with-dependencies</id>
	<formats>
		<format>jar</format>
	</formats>
	<includeBaseDirectory>false</includeBaseDirectory>
	<dependencySets>
		<dependencySet>
			<unpack>true</unpack>
			<scope>runtime</scope>
			<unpackOptions>
				<filtered>true</filtered>
				<excludes>
					<!-- Unfortunately the approach to put everything in the same jars doesn't allow to have multiple instances
					of SPI declarations. So, we have to exclude this and name the class it links in our own version of the same
					file -->
					<!-- exclude>META-INF/services/info.marcobrandizi.rdfutils.namespaces.Namespaces</exclude -->
					<exclude>**/MANIFEST.MF</exclude>
					<!-- As said above, we have our own, so keep this out of the way -->
					<exclude>workflow-component-description.xml</exclude>
				</excludes>
			</unpackOptions>
			<excludes>
				<exclude>META-INF</exclude>
			</excludes>
		</dependencySet>
	</dependencySets>
	<fileSets>
		<fileSet>
			<directory>${project.build.directory}/wf-descriptor</directory>
			<includes>
				<include>*.xml</include>
				<include>*.xsl</include>
			</includes>
			<outputDirectory>/</outputDirectory>
      <fileMode>0644</fileMode>
			<directoryMode>0755</directoryMode>			
		</fileSet>
		<fileSet>
			<directory>${project.build.directory}/classes</directory>
			<includes>
			 	<!-- See above -->
				<include>workflow-component-description.xml</include>
			  <include>META-INF/services/info.marcobrandizi.rdfutils.namespaces.Namespaces</include>				
			</includes>
			<outputDirectory>/</outputDirectory>
      <fileMode>0644</fileMode>
			<directoryMode>0755</directoryMode>			
		</fileSet>
	</fileSets>
</assembly>